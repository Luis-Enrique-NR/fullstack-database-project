# 13.2. Escenario de Uso

## Contexto

En el proceso productivo y logístico de la empresa de referencia, la **trazabilidad** es fundamental para responder a preguntas críticas como:  
- ¿Qué lotes de insumos se usaron para producir un lote específico de producto?
- ¿Qué procesos y empleados intervinieron en la fabricación?
- ¿Cómo se almacenó, pickeó y distribuyó el lote?
- ¿Qué clientes recibieron dicho lote, a través de qué órdenes de carga y en qué contexto?

En el modelo relacional tradicional, responder a estas preguntas puede exigir consultas complejas con múltiples JOINs, subconsultas y manejo de tablas intermedias. Esto puede ser poco eficiente y difícil de mantener, especialmente a medida que aumenta la complejidad y el volumen de datos.

## Ventaja de ArangoDB y el Modelo de Grafos

Con ArangoDB y su modelo de grafos, **la trazabilidad se vuelve y eficiente**. Cada entidad clave (lote de producto, lote de insumo, proceso, empleado, almacén, orden de carga, cliente) se representa como un **nodo** y las relaciones directas como **aristas** (edges). Así, el camino completo de un lote desde el insumo hasta la entrega al cliente queda representado en el grafo y se puede recorrer de manera directa.

## Ejemplo de Escenario de Uso: Trazabilidad de Lotes desde Insumo a Cliente

Supongamos que un auditor, cliente o responsable de calidad necesita saber:

> “Para el lote de producto `LP000001` entregado al cliente ‘Retail Quinua Perú’, ¿qué lotes de insumo se utilizaron en su fabricación, qué procesos y empleados intervinieron, y a través de qué orden de carga fue entregado?”

### **Camino de Trazabilidad en el Grafo:**

1. **Lote de Producto (`LotesProducto`)**  
   Nodo: `LP000001`
2. **Procesos Productivos**  
   Nodos: Dosificado, Mezclado, Moldeado, Secado, Envasado (cada proceso asociado al lote)
   - Relaciones:  
     - `REALIZADO_EN` (LoteProducto → Proceso)
     - `PARTICIPADO_POR` (Proceso → Empleado)
     - `EJECUTADO_EN` (Proceso → Máquina, si aplica)
3. **Lotes de Insumo**  
   Nodos: `LI000001`, `LI000002`, etc.
   - Relación: `UTILIZO` (Proceso Dosificado → LoteInsumo)
4. **Almacén / Picking / Entrega**  
   Nodos/Edges:  
   - `ALMACENADO_EN`, `ASIGNADO_A_PICKING`, `ENTREGADO_EN`
   - Relacionan lote de producto con almacén, picking y registro de entrega
5. **Órdenes de Carga y Clientes**  
   Nodos: Orden de Carga, Cliente
   - Relaciones:  
     - `DESPACHADO_POR` (Entrega → Orden de Carga)
     - `RECIBIDO_POR` (Entrega → Cliente)

### **Ventajas en la consulta:**

- **Consulta directa**: Un solo recorrido en el grafo permite obtener todos los datos conectados al lote de producto.
- **Flexibilidad**: Si se agregan nuevos procesos, áreas o actores, se pueden incorporar fácilmente como nuevos nodos y aristas.
- **Transparencia y auditoría**: Es sencillo visualizar todo el recorrido de un lote y responder a solicitudes regulatorias o de clientes.

---

## **Conclusión del Escenario**

Este escenario demuestra cómo un modelo de grafos multi-etapa permite gestionar la trazabilidad de manera eficiente y clara, resultando en una solución más potente y flexible frente al modelo relacional clásico en contextos de cadena de producción y distribución complejas.